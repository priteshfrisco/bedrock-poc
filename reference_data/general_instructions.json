{
  "safety_warnings": "⚠️  BEFORE EXTRACTING ATTRIBUTES, CHECK IF THIS IS A NON-SUPPLEMENT:\n\nIf the title appears to be a NON-SUPPLEMENT product (not a dietary supplement),\nreturn \"REMOVE\" for all fields.\n\n{safety_check}\n\n✅ IMPORTANT: These ARE supplements (do NOT mark as REMOVE):\n  • Sports drinks / Electrolyte drinks with vitamins/minerals (Gatorade, Sqwincher, Pedialyte)\n  • Protein shakes and meal replacement drinks\n  • Vitamin/mineral beverages (liquid supplements)\n  • Hydration formulas with electrolytes\n  • Energy drinks with vitamins/supplements\n\n❌ These are NOT supplements (mark as REMOVE):\n  • Regular food items (except bars/shakes designed as supplements)\n  • Personal care products (lotions, shampoos, soaps)\n  • Books, DVDs, equipment\n  • Apparel and jewelry\n  • Non-nutritional beverages (regular soda, plain juice)\n\nIF NON-SUPPLEMENT DETECTED (and no exceptions apply):\nReturn JSON with ALL values set to \"REMOVE\":\n{{\n  \"age\": {{\"value\": \"REMOVE\", \"reasoning\": \"Non-supplement detected: [reason]\"}},\n  \"gender\": {{\"value\": \"REMOVE\", \"reasoning\": \"Non-supplement detected: [reason]\"}},\n  \"form\": {{\"value\": \"REMOVE\", \"reasoning\": \"Non-supplement detected: [reason]\"}},\n  \"organic\": {{\"value\": \"REMOVE\", \"reasoning\": \"Non-supplement detected: [reason]\"}}\n}}\n\nThis is a SAFETY NET in case non-supplements slip through Step 1 filtering.",
  
  "task_description": "You will extract 7 attributes from the product title. For EACH attribute, you must:\n1. Search for matching keywords\n2. Apply any priority rules if needed\n3. Provide your reasoning\n4. Output the final value",
  
  "false_positive_warnings": "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n⚠️  CRITICAL: AVOID FALSE POSITIVES FROM BRAND/INGREDIENT NAMES\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n\nIGNORE keywords that appear in:\n  • Brand names (e.g., \"Women's Best\" is a brand, NOT a gender indicator)\n  • Ingredient names (e.g., \"Elderberry\" contains \"elder\", NOT an age indicator)\n  \nOnly EXTRACT keywords that describe:\n  • Target audience (age/gender) as a DESCRIPTOR\n  • Physical delivery form (not ingredient state)\n  • Organic certification\n\nExamples:\n  ✅ CORRECT: \"Women's Daily Multivitamin\" → \"Women's\" = gender descriptor\n  ✅ CORRECT: \"Kids Chewable\" → \"Kids\" = age descriptor\n  ✅ CORRECT: \"Turmeric Powder in Capsules\" → Form = \"Capsules\" (NOT powder)\n  ❌ WRONG: \"Elderberry Extract\" → Do NOT extract \"elder\" as age\n  ❌ WRONG: Brand=\"Baby's Only\" → Do NOT extract \"baby\" from brand\n\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━",
  
  "output_format_instructions": "OUTPUT FORMAT:\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n\nReturn a JSON object with this structure:\n\n{{\n  \"age\": {{ \"value\": \"AGE GROUP - NON SPECIFIC\", \"reasoning\": \"...\" }},\n  \"gender\": {{ \"value\": \"GENDER - NON SPECIFIC\", \"reasoning\": \"...\" }},\n  \"form\": {{ \"value\": \"SOFTGEL\", \"reasoning\": \"...\" }},\n  \"organic\": {{ \"value\": \"N/A\", \"reasoning\": \"...\" }},\n  \"count\": {{ \"value\": \"60\", \"reasoning\": \"...\" }},\n  \"unit\": {{ \"value\": \"N/A\", \"reasoning\": \"...\" }},\n  \"size\": {{ \"value\": \"1\", \"reasoning\": \"...\" }},\n  \"potency\": {{ \"value\": \"5000 IU\", \"reasoning\": \"...\" }},\n  \"ingredients\": [ /* array from lookup_ingredient calls */ ],\n  \"primary_ingredient\": \"multivitamin\",\n  \"business_rules\": {{\n    \"initial_category\": \"COMBINED MULTIVITAMINS\",\n    \"initial_subcategory\": \"COMBINED MULTIVITAMINS\",\n    \"final_category\": \"COMBINED MULTIVITAMINS\",\n    \"final_subcategory\": \"WOMEN\",\n    \"primary_ingredient\": \"MULTIPLE VITAMIN\",\n    \"has_changes\": true,\n    \"has_unknown\": false,\n    \"reasoning\": \"Subcategory refined from COMBINED MULTIVITAMINS to WOMEN based on gender.\"\n  }}\n}}\n\nIMPORTANT:\n- Always provide reasoning for EVERY attribute extraction\n- For count: Be careful NOT to confuse dosage (mg, IU) with count\n- For size: Default to 1 if no pack keywords found\n- For ingredients: Call lookup_ingredient() for EACH ingredient found\n- For business_rules: Call apply_business_rules() AFTER extracting all ingredients\n\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━",
  
  "workflow_instructions": "WORKFLOW (CRITICAL - FOLLOW EXACTLY):\n1. Extract age, gender, form, organic, count, unit, size, potency from the title\n2. Extract ingredient names from the title\n3. For EACH ingredient, call lookup_ingredient() to get category/subcategory\n4. ⚠️  AFTER ALL lookups are complete, you MUST call apply_business_rules()\n   with the ingredients array, age_group, gender, and title\n\n⚠️  CRITICAL: You MUST call apply_business_rules() - it determines final category/subcategory!\n\nInterpret the title as best as you can and extract all relevant attributes.",
  
  "formatting_issues_warning": "IMPORTANT: The title may have formatting issues:\n- No spaces between words (e.g., \"PrenatalMultivitamin\")\n- All caps or inconsistent capitalization\n- Special characters or typos\n- Missing punctuation\n\nYour task is to extract information accurately DESPITE these formatting issues.\nInterpret the title as best as you can and extract all relevant attributes.",

  "_notes": "This file consolidates ALL general prompt instructions. The {safety_check} placeholder will be replaced with formatted keywords from non_supplement_keywords.csv at runtime."
}

